{"componentChunkName":"component---node-modules-pauliescanlon-gatsby-theme-terminal-src-layouts-source-layout-js","path":"/posts/2021/06/gatsby-abstracted-functions/","result":{"data":{"mdx":{"id":"aa3ebb7c-4601-5532-9753-d20e186b585b","body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Using Gatsby Functions as an abstracted API\",\n  \"tags\": [\"React\", \"Gatsby\", \"Gatsbv Functions\", \"JavaScript\", \"Gatsby Plugins\"],\n  \"date\": \"2021-06-11T00:00:00.000Z\",\n  \"author\": \"Paul Scanlon\",\n  \"featuredImageUrl\": \"https://res.cloudinary.com/www-paulie-dev/image/upload/v1623406763/paulie.dev/2021/06/gatsby-abstracted-functions_ordai0.jpg\"\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar Divider = makeShortcode(\"Divider\");\nvar Tweet = makeShortcode(\"Tweet\");\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"They're here! Gatsby Functions are here! They're finally here! \\uD83D\\uDC9D -- And I couldn't be more excited!\"), mdx(\"p\", null, \"A little while ago I wrote a post about using the Twitter API as a kind of CMS for my blog. You can read more about that\\nhere:\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://paulie.dev/posts/2020/11/gatsby-netlify-twitter/\"\n  }), \"Use Netlify Functions and the Twitter API v2 as a CMS for your Gatsby blog\")), mdx(\"p\", null, \"In short I created my own mini API that is used by both my commercial portfolio:\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://www.pauliescanlon.io\"\n  }), \"https://www.pauliescanlon.io\"), \" and my blog: \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://paulie.dev\"\n  }), \"https://paulie.dev\"), \" to\\ndisplay my current Twitter bio information on the home page(s).\"), mdx(\"p\", null, \"Both my sites are built on top of my Gatsby theme\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/PaulieScanlon/gatsby-theme-terminal\"\n  }), \"gatsby-theme-terminal\"), \" which I haven't updated to Gatsby\\n\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"v3.x.x\"), \" yet, and both sites are currently hosted by Netlify... but I didn't want that to hold me up from adopting\\nGatsby Functions.\"), mdx(\"p\", null, \"Here's how I did it. \\uD83D\\uDC47\"), mdx(\"p\", null, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"#api\"\n  }), \"API\")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"demo: \", mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://paulieapi.gatsbyjs.io/\"\n  }), \"https://paulieapi.gatsbyjs.io/\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"source code: \", mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://github.com/PaulieScanlon/paulie-api\"\n  }), \"https://github.com/PaulieScanlon/paulie-api\"), \",\")), mdx(\"p\", null, \"My API is actually a very simple Gatsby Site deployed on \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://www.gatsbyjs.com/products/cloud/\"\n  }), \"Gatsby Cloud\"), \". It\\ndisplays the response from my endpoints in HTML \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"<pre>\"), \" tags. This isn't entirely necessary but it allows me to test a\\nrequest and preview the responses in an almost real and un-abstracted way.\"), mdx(\"p\", null, \"You can also see the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"json\"), \" response for each of my endpoints using the links below:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"twitter-user: \", mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://paulieapi.gatsbyjs.io/api/twitter-user\"\n  }), \"https://paulieapi.gatsbyjs.io/api/twitter-user\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"github-user: \", mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://paulieapi.gatsbyjs.io/api/github-user\"\n  }), \"https://paulieapi.gatsbyjs.io/api/github-user\"))), mdx(\"p\", null, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"#functions\"\n  }), \"Functions\")), mdx(\"p\", null, \"To use Gatsby Functions have a read of the\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://www.gatsbyjs.com/docs/reference/functions/getting-started/\"\n  }), \"Getting Started docs\"), \" but i'll break down the steps\\nyou'll probably need to use Gatsby Functions anyway\"), mdx(\"h2\", null, \"Install Dependencies\"), mdx(\"p\", null, \"You'll need Gatsby \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"3.4.0\"), \" or higher installed\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-sh\"\n  }), \"npm install gatsby@latest\\n\\n\")), mdx(Divider, {\n    mdxType: \"Divider\"\n  }), mdx(\"h2\", null, \"Enable Feature Flag\"), mdx(\"p\", null, \"Gatsby Functions are still technically in beta so you'll need to add\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/gatsbyjs/gatsby/discussions/30735\"\n  }), \"FUNCTIONS\"), \" as a feature flag in your \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"gatsby-config.js\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-javascript\"\n  }), \"// gatsby-config.js\\n\\nmodule.exports = {\\n  flags: {\\n    FUNCTIONS: true\\n  },\\n  plugins: [...]\\n}\\n\\n\")), mdx(Divider, {\n    mdxType: \"Divider\"\n  }), mdx(\"p\", null, \"\\uD83D\\uDEA8 News just in from Joel Sumner Smith | Product Manager \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://twitter.com/gatsbyjs\"\n  }), \"@Gatsby\"), \"\\uD83D\\uDC47\"), mdx(Tweet, {\n    tweetLink: \"jsumnersmith/status/1403333241604653056\",\n    mdxType: \"Tweet\"\n  }), mdx(Divider, {\n    mdxType: \"Divider\"\n  }), mdx(\"h2\", null, \"File System - API\"), mdx(\"p\", null, \"Like with the \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://www.gatsbyjs.com/docs/reference/routing/file-system-route-api/\"\n  }), \"File System Route API\"), \" The path\\nto Functions is the same on disk as it would be in browser: E.g \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"src/api/some-function\"), \" =>\\n\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"http(s)://.../api/some-function\")), mdx(\"h2\", null, \"Endpoint\"), mdx(\"p\", null, \"I have x2 two endpoints in my API they both work in the same way but here's the\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/PaulieScanlon/paulie-api/blob/main/src/api/twitter-user.js\"\n  }), \"twitter-user\"), \" endpoint\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-javascript\"\n  }), \"// api/twitter-user.js\\n\\nconst { twitter } = require('../clients') // exports Twitter client\\n\\nexport default async function handler(req, res) {\\n  res.setHeader('Access-Control-Allow-Origin', '*') // YOLO\\n  try {\\n    const { data } = await twitter.get('users/by/username/PaulieScanlon', {\\n      user: {\\n        fields:\\n          'created_at,description,entities,id,location,name,pinned_tweet_id,profile_image_url,protected,public_metrics,url,username,verified,withheld',\\n      },\\n    })\\n    res.status(200).json({\\n      user: data,\\n    })\\n  } catch {\\n    res.status(500).json({\\n      error: 'Ooops server error',\\n    })\\n  }\\n}\\n\")), mdx(Divider, {\n    mdxType: \"Divider\"\n  }), mdx(\"h2\", null, \"Request\"), mdx(\"p\", null, \"I use \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"fetch\"), \" to hit my API and set the response in state which is then returned by Jsx.\"), mdx(\"p\", null, \"I fetch the data in the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"ProfileInfo.js\"), \" component in both my\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/PaulieScanlon/paulie-dev-2019/blob/main/src/components/ProfileInfo/ProfileInfo.js\"\n  }), \"blog\"), \" and my\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/PaulieScanlon/pauliescanlon-2020/blob/master/src/components/ProfileInfo/ProfileInfo.js\"\n  }), \"site\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-javascript\"\n  }), \"// Any React component\\n\\n...\\n\\n  const [twitter, setTwitter] = useState({ user: null })\\n\\n  useEffect(() => {\\n    fetch('https://paulieapi.gatsbyjs.io/api/twitter-user')\\n      .then((response) => {\\n        if (response.status >= 200 && response.status <= 299) {\\n          return response.json()\\n        } else {\\n          throw Error(response.message)\\n        }\\n      })\\n      .then((response) => {\\n        // Save response in state hook\\n        setTwitter(response)\\n      })\\n      .catch((error) => {\\n        // Handle the error\\n      })\\n  }, [])\\n\\n  return (\\n    <div>\\n      {twitter.user ? (\\n        <Fragment>\\n          <h2>Twitter User</h2>\\n          <pre>\\n            <code>{JSON.stringify(twitter.user, null, 2)}</code>\\n          </pre>\\n        </Fragment>\\n      ) : null}\\n    </div>\\n  )\\n\\n...\\n\\n\")), mdx(Divider, {\n    mdxType: \"Divider\"\n  }), mdx(\"p\", null, \"... and that's pretty much it. I might at some point do something with the GitHub data but I just wanted to share how\\ni'm using Gatsby Functions in an abstracted and potentially easily incrementally adoptable way. -- jeez what a sentence!\\n\\uD83D\\uDD7A\"));\n}\n;\nMDXContent.isMDXComponent = true;","excerpt":"They're here! Gatsby Functions are here! They're finally here! 💝 -- And I couldn't be more excited! A little while ago I wrote a post about…","timeToRead":2,"wordCount":{"words":406},"slug":"2021/06/gatsby-abstracted-functions","frontmatter":{"title":"Using Gatsby Functions as an abstracted API","tags":["React","Gatsby","Gatsbv Functions","JavaScript","Gatsby Plugins"],"date":"2021-06-11T00:00:00.000Z","dateModified":null,"author":"Paul Scanlon","status":null,"isPrivate":null,"url":null,"misc":null,"pinned":null,"featuredImage":null,"embeddedImages":null},"featuredImageUrl":{"url":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDAAoHBwgHBgoICAgLCgoLDhgQDg0NDh0VFhEYIx8lJCIfIiEmKzcvJik0KSEiMEExNDk7Pj4+JS5ESUM8SDc9Pjv/2wBDAQoLCw4NDhwQEBw7KCIoOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozv/wgARCAALABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAUDBAb/xAAVAQEBAAAAAAAAAAAAAAAAAAADBf/aAAwDAQACEAMQAAAB1VButUkhGVI//8QAGRAAAwEBAQAAAAAAAAAAAAAAAQIDAAQz/9oACAEBAAEFAhRjW7NSLqFbdvhv/8QAFxEAAwEAAAAAAAAAAAAAAAAAAQMQMv/aAAgBAwEBPwF2DP/EABcRAAMBAAAAAAAAAAAAAAAAAAEDEDL/2gAIAQIBAT8BVsT/xAAdEAACAQQDAAAAAAAAAAAAAAABAhIAEBEiQmGB/9oACAEBAAY/AmSBAHKtlhtWA0u7e2//xAAcEAEAAgEFAAAAAAAAAAAAAAABADERECFBUbH/2gAIAQEAAT8hZhLbtMAqQVzGZgcKjU8On//aAAwDAQACAAMAAAAQCB//xAAXEQEBAQEAAAAAAAAAAAAAAAABABGh/9oACAEDAQE/EOKXXS//xAAYEQEAAwEAAAAAAAAAAAAAAAABABEhQf/aAAgBAgEBPxBFFdIYbP/EABwQAAEEAwEAAAAAAAAAAAAAAAEAESExEEFR8P/aAAgBAQABPxAV85IYPjIiHGOBi8mq3pMHFBhItLdD7Vip8Xj/2Q=="},"images":{"fallback":{"src":"/static/71d28c3746c5357689699e94f9ae9239/ccd19/gatsby-abstracted-functions_ordai0.jpg","srcSet":"/static/71d28c3746c5357689699e94f9ae9239/5de87/gatsby-abstracted-functions_ordai0.jpg 750w,\n/static/71d28c3746c5357689699e94f9ae9239/ccd19/gatsby-abstracted-functions_ordai0.jpg 1024w","sizes":"100vw"},"sources":[{"srcSet":"/static/71d28c3746c5357689699e94f9ae9239/5846e/gatsby-abstracted-functions_ordai0.avif 750w,\n/static/71d28c3746c5357689699e94f9ae9239/47b7d/gatsby-abstracted-functions_ordai0.avif 1024w","type":"image/avif","sizes":"100vw"},{"srcSet":"/static/71d28c3746c5357689699e94f9ae9239/d02c5/gatsby-abstracted-functions_ordai0.webp 750w,\n/static/71d28c3746c5357689699e94f9ae9239/d819f/gatsby-abstracted-functions_ordai0.webp 1024w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.5625}}}},"embeddedImageUrls":null,"fields":{"slug":"/posts/2021/06/gatsby-abstracted-functions/","owner":"source","parent":"posts"}}},"pageContext":{"id":"aa3ebb7c-4601-5532-9753-d20e186b585b","prev":{"frontmatter":{"title":"Add data to Gatsby's GraphQL layer using sourceNodes","status":null},"fields":{"slug":"/posts/2021/07/gatsby-source-nodes/"}},"next":{"frontmatter":{"title":"Gatsby Cloud: Better, Faster... Greener?","status":null},"fields":{"slug":"/writing/2021/04/gatsby-cloud-better-faster-greener/"}},"parent":"posts"}},"staticQueryHashes":["1095393795","1469902088","2504239491","3642847879","571831435"]}